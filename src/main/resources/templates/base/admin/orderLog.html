<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <title>预约管理</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Sufee Admin - HTML5 Admin Template</title>
    <meta name="description" content="Sufee Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="apple-icon.png">
    <link rel="shortcut icon" href="../../static/user/favicon.ico">
    <link rel="stylesheet" href="../../static/user/vendors/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../static/user/vendors/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../static/user/vendors/themify-icons/css/themify-icons.css">
    <link rel="stylesheet" href="../../static/user/vendors/flag-icon-css/css/flag-icon.min.css">
    <link rel="stylesheet" href="../../static/user/vendors/datatables.net-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="../../static/user/vendors/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css">

    <link rel="stylesheet" href="../../static/user/assets/css/style.css">

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800' rel='stylesheet' type='text/css'>
</head>

<body>
<!-- Left Panel -->

<aside id="navbar" class="left-panel">
</aside><!-- /#left-panel -->

<!-- Left Panel -->

<!-- Right Panel -->

<div id="right-panel" class="right-panel">

    <!-- Header-->
    <header id="header" class="header">
    </header><!-- /header -->
    <!-- Header-->


    <div class="content mt-3">
        <div class="animated fadeIn">
            <div class="row">

                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <strong class="card-title">预约管理</strong>
                            <!--                            添加按钮-->
                            <button style="float: right; background-color: transparent" data-toggle='modal' data-target='#exampleModalCenter' onclick="showDiv(null,'add')"><svg  class="bi bi-person-plus-fill" width="2em" height="2em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 100-6 3 3 0 000 6zm7.5-3a.5.5 0 01.5.5v2a.5.5 0 01-.5.5h-2a.5.5 0 010-1H13V5.5a.5.5 0 01.5-.5z" clip-rule="evenodd"/>
                                <path fill-rule="evenodd" d="M13 7.5a.5.5 0 01.5-.5h2a.5.5 0 010 1H14v1.5a.5.5 0 01-1 0v-2z" clip-rule="evenodd"/>
                            </svg></button>
                        </div>
                        <div class="card-body">
                            <table id="bootstrap-data-table-export" class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th>用户名</th>
                                    <th>车牌号</th>
                                    <th>停车场名</th>
                                    <th>车位编号</th>
                                    <th>预约时间</th>
                                    <th>预约状态</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>


            </div>
        </div><!-- .animated -->
    </div><!-- .content -->


</div><!-- /#right-panel -->

<!--    修改弹窗-->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="showDivusername">用户名</label>
                        <input type="text" class="form-control" id="showDivusername">
                    </div>
                    <div class="form-group">
                        <label for="showDivplateCode">车牌号</label>
                        <input type="text" class="form-control" id="showDivplateCode">
                    </div>
                    <div class="form-group">
                        <label for="showDivparkingName">停车场名</label>
                        <input type="text" class="form-control" id="showDivparkingName">
                    </div>
                    <div class="form-group">
                        <label for="showDivCarportNum">车位编号</label>
                        <input class="form-control" type="text" id="showDivCarportNum">
                    </div>
                    <div>
                        <label for="showDivorderTime">预约时间</label>
                        <input type="text" class="form-control" id="showDivorderTime">
                    </div>
                    <div>
                        <label for="showDivorderStatus">预约状态</label>
                        <select class="form-control" id="showDivorderStatus" name="status">
                            <option value="0">预约中</option>
                            <option value="1">预约完成</option>
                            <option value="2">预约失败</option>
                        </select>
                    </div>
                    <input type="text" style="display: none" id="showDivuserId">
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" onclick="updateSave()">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- Right Panel -->


<script src="../../static/user/vendors/jquery/dist/jquery.min.js"></script>
<script src="../../static/user/vendors/popper/popper.min.js"></script>
<script src="../../static/user/vendors/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="../../static/user/assets/js/main.js"></script>


<script src="../../static/user/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../../static/user/vendors/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="../../static/user/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="../../static/user/vendors/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
<script src="../../static/user/vendors/jszip/dist/jszip.min.js"></script>
<script src="../../static/user/vendors/pdfmake/build/pdfmake.min.js"></script>
<script src="../../static/user/vendors/pdfmake/build/vfs_fonts.js"></script>
<script src="../../static/user/vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="../../static/user/vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="../../static/user/vendors/datatables.net-buttons/js/buttons.colVis.min.js"></script>
<script src="../../static/user/assets/js/init-scripts/data-table/datatables-init-orderLog.js"></script>

<script src="http://apps.bdimg.com/libs/jquery/1.6.4/jquery.min.js"></script>
<script>
    $("#navbar").load("../../base/admin/navbar.html");
    $("#header").load("../../base/admin/base_right_header.html");
</script>

<script>
    //保存修改和添加
    function updateSave() {
        var userId = $("#showDivuserId").val();
        //修改
        if(userId != null){
            //保存数据
            //获取值
            var showDivusername = $("#showDivusername").val();
            var plateCode= $("#showDivplateCode").val();
            var parkingName = $("#showDivparkingName").val();
            var CarportNum = $("#showDivCarportNum").val();
            var orderTime = $("#showDivorderTime").val();
            var orderStatus = $("#showDivorderStatus").val();
            //发送请求
            var url="/user/parking/updateParking";
            $.post(url,{userId:userId,orderStatus:orderStatus},
                function (data) {
                    //回调方法
                    if(data.status){
                        //修改成功
                        alert("修改成功");
                        //刷新页面
                        location.reload();
                    }else {
                        alert("修改失败")
                    }
                },"json"
            );
        }else{
            //添加获取值
            var showDivusername = $("#showDivusername").val();
            var plateCode= $("#showDivplateCode").val();
            var parkingName = $("#showDivparkingName").val();
            var CarportNum = $("#showDivCarportNum").val();
            var orderTime = $("#showDivorderTime").val();
            var orderStatus = $("#showDivorderStatus").val();
            //发送请求
            var url="/user/parking/addParking";
            $.post(url,{showDivusername:showDivusername,plateCode:plateCode,parkingName:parkingName,CarportNum:CarportNum,orderTime:orderTime,orderStatus:orderStatus},
                function (data) {
                    //回调方法
                    if(data.status){
                        //添加成功
                        alert("添加成功");
                        //刷新页面
                        location.reload();
                    }else {
                        alert("添加失败")
                    }
                },"json"
            );
        }


    }
    // 打开弹窗
    function showDiv( row , methodType )  {
       $("#showDivusername").val("");
        $("#showDivplateCode").val("");
        $("#showDivparkingName").val("");
        $("#showDivCarportNum").val("");
        $("#showDivorderTime").val("");
        $("#showDivorderStatus").val("");

        $("#showDivusername").removeAttr("disabled");
        $("#showDivplateCode").removeAttr("disabled");
        $("#showDivparkingName").removeAttr("disabled");
        $("#showDivCarportNum").removeAttr("disabled");
        $("#showDivorderTime").removeAttr("disabled");
        $("#showDivorderStatus").removeAttr("disabled");
        if(methodType=="add"){
            //添加
            $("#exampleModalCenterTitle").text("添加预约");

        }else {
            //修改
            $("#showDivusername").val(row.username);
            $("#showDivplateCode").val(row.plateCode);
            $("#showDivparkingName").val(row.parkingName);
            $("#showDivCarportNum").val(row.carportNum);
            $("#showDivorderTime").val(row.orderCarportTime);
            $("#showDivorderStatus").val(row.orderCarportStatus);
            //禁止修改除状态之外的数据
            $("#showDivusername").attr({disabled:"true"});
            $("#showDivplateCode").attr({disabled:"true"});
            $("#showDivparkingName").attr({disabled:"true"});
            $("#showDivCarportNum").attr({disabled:"true"});
            $("#showDivorderTime").attr({disabled:"true"});
            var status = row.orderCarportStatus;
            if(status != 0){
                $("#showDivorderStatus").attr({disabled:"true"});
            }
            $("#exampleModalCenterTitle").text("修改");
        }
        $("#updateOrAddDiv").show();
    }
</script>
</body>

</html>
